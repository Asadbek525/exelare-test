<div [class.bg-blue-100]="isDragOver()">
  <div
    class="flex items-center justify-between cursor-pointer transition-all rounded-md px-2"
    [class.bg-gray-100]="item().expanded"
    #node
    (dragenter)="dragEntered($event)"
    (dragleave)="dragLeft($event)"
    (drop)="drop($event)"
    (dragover)="dragOver($event)"
    [draggable]="item().draggable"
  >
    <button
      class="flex items-center gap-2 p-2"
      (click)="navigate()"
      [class.text-blue-600]="item().link === router.url"
    >
      <i [class]="item().icon"></i>
      {{ item().label }}
    </button>
    @if (item().children) {
      <button
        (click)="toggle()"
        class="cursor-pointer transition-all"
        [class.text-blue-600]="item().link === router.url"
      >
        <i
          class="pi pi-chevron-right text-sm"
          [@rotateIcon]="item().expanded ? 'expanded' : 'collapsed'"
        ></i>
      </button>
    }
  </div>
  <p-contextMenu [target]="node" [model]="contextMenuItems" />
  @if (item().children) {
    <div class="ml-4" [@expandCollapse]="item().expanded ? 'expanded' : 'collapsed'">
      @for (child of item().children; track child.id) {
        <app-tree-node [item]="child"></app-tree-node>
      } @empty {
        No children
      }
    </div>
  }
</div>
